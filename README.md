### マッピングまで(パイプライン化されている)  
***
Miseqでシーケンスをかけると，読まれた配列が1リードごとに記載されたFASTQファイルが出力されます。  
pair endで読んでいる場合，ライブラリーの両端を読んでいる配列が別々のファイルとして出力されるため，1サンプルにつき２つのFASTQファイルが出力されます。  
RNAseqの解析をする場合，これらの配列をリファレンス配列にマッピングし，遺伝子情報のアノテーション配列と照らし合わせることで発現量を計算するという流れが必要になります。  
***  
<解析の流れ>  
・flexbarというツールでアダプター配列などの無駄な配列を除去します。(FASTQ形式)  
・HISAT2というツールでリファレンス配列に，シーケンスで得られた配列をマッピングします。(bam形式)  
・stringtieというアセンブリツールで，遺伝子ごとの発現情報など様々な情報を得ます。(gtf形式)  
これ以外にも色々な操作を行なっているが，RNAseqを理解するのに重要なのは特にHISAT2によるマッピングと，stringtieによるアセンブル。
<br>  

### 得られるファイル  
***  
**'count_matrix.txt'**:featurecountsによって転写物ごとのリード数をサンプル毎にカウントした結果が1ファイルにまとまっている。edgeRでの発現量比較などに用いる。  
**'tpm_matrix.txt'** : stringtieによって得られたサンプルごとのTPMが1ファイルにまとまっている。 
それ以外のファイルは主にQCレポート作成用。  
遺伝子ごとのTPMやカウント結果以外の情報を用いて，少しひねった解析を行いたい場合，別途pythonなどでスクリプトを作成しファイルを作成する必要が出てくる。(ここら辺は言っていただければ書きます。)  
***  
<br>  

### Rでの解析  
主に使うパッケージ  
・**dplyr**，tidyverse：データフレームを扱うのに便利。  
・**edgeR**：発現量比較を行う際に用いる。  
・**ggplot2**：グラフを書くのに用いる。  
