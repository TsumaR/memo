# RNA-seqに使えるツール　
近年のRNA-seq解析の進展は凄まじく，基本的に下流解析においてはSeurat，scanpy，Monocleといった主要なソフトウェアが地位を確立した。解析が簡単に行えるようになった現在では，細胞をクラスタリングし，マーカー遺伝子を定義するだけの解析を行う時代は終わったと言える。そのため，分化解析など様々な応用的解析を行えるようになっておくことが必要となる。 

## 事前処理
### Normalization 
シングルセルRNA-seqのようなデータではCPMで発言量比較を行うべきではない。CPMはサンプルあたりのリード数の差が実験主義によるものだけであると仮定している。そのため，scRNA-seqのようにサンプルごとにそもそも保有する遺伝子の量が違うサンプルを比較する上では適さない。 
また，さらに大変な点として，scRNA-seqにおいては常にある正規化が正しいという決まった正規化の手法があるわけではない。そこで，現状では[Scone](https://www.sciencedirect.com/science/article/abs/pii/S2405471219300808?via%3Dihub) というツールを使用し，そのデータセットに適した正規化手法を探るのがベストっぽい(2019 6月現在)
一方で，full-lengthを取ってくるRNA-seq手法においては長さを考慮して正規化することが重要となってくる。多くの場合で利用されているのはTPMであり，多少偽陽性を削減することがわかっている。[[1]](https://www.nature.com/articles/nmeth.4612)
(*しかし，TPMでは上の欠点を除去できていない。シングルセル用のTPMみたいのがあるのか調べる必要がある。*)
また，第一種の過誤(帰無仮説が真であるのにも関わらず，帰無仮説を偽として棄却してしまう誤りのこと。すなわち偽陽性)は，低発現遺伝子を除外するとで，ほとんどのツールにおいてパフフォーマンスが大幅に安定化する。[[1]](https://www.nature.com/articles/nmeth.4612) 
多くの場合，正規化後に`log(x+1)`の変換を行い，比較をする。正規分布を仮定する多くのツールに用いるためや，1セルごとの平均や分散の関係を軽減するなど多くの利点がある。
非全長データセットの正規化にはscran，全長の場合はTPM(CPM)でよい。

#### 遺伝子数の正規化 
遺伝子のカウントデータをz scoreに変換する流派もある。下流の解析で全ての遺伝子を対等に扱うことができるためである。ただし，多くの生物学的情報が失われる側面もあるので意見が別れているところ。この場合，正規化後に`log(x+1)`の変換を行う。

### バッチ処理　
`ComBat`，Mutual Nearest Neighbors(Haghverdi et al., 2018)など色々な手法があるが，現状でどれが優れているか判断するのは難しい。

## 遺伝子発現リファレンスデータセット 
### Tabula muris 
### RefEx 
相対発現量を人体3Dマップしたものを見ることができる。組織ごとにCAGEやRNA-seqでどうなっているかを見ることができる。GOやGTExへのリンクもある。確認用に利用するのが良さそう。

## 配列検索 
### GGGenome 
pandasでそのまま`read_csv`することも可能。 

## 可視化ツール　
[SCope](http://scope.aertslab.org/#/363ee765-464b-40c7-98e6-daba8a91a956/*/welcome) 

## 転写因子解析 
### wPGSA
### SCENIC 
遺伝子発現ネットワーク解析 

### scTsnsor，cellphoneDB 
receptor-ligandネットワーク解析　

# 参考文献　
https://www.embopress.org/doi/10.15252/msb.20188746